<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>

	<style>
		/* .iframe {
			width: 100vw;
			height: 100vh;
		} */
	</style>
</head>
<body>
	<iframe id="myiframe" class="iframe" src="https://www.baidu.com" frameborder="0"></iframe>
	<!-- <iframe id="myiframe" class="iframe" src="http://localhost:8080/child.html" frameborder="0"></iframe> -->

	<script>
		 
		// 获取 iframe 元素
		iFrame = document.getElementById('myiframe')

		// iframe 加载完毕后再发送消息，否则子页面接收不到 message
		iFrame.onload = function(){
			// 跨域是 contentDocument 为 null。
			var iwindow = iframe.contentWindow;
			// 跨域的时候 window 上面没有 document
			// var idoc = iwindow.document;
			iframe.height = idoc.body.offsetHeight;

			
		  //iframe加载完立即发送一条消息
		  iFrame.contentWindow.postMessage('MessageFromIndex1','*');

		}



		const str = '?key1=value1&key2=value2&key3=value3&key3=value4'

		function parseURL(str) {
			const obj = {}
			str.replace(/&?\??(\w+)=(\w+)/g, (match, key, value) => {
				if (typeof obj[key] === 'undefined') {
					obj[key] = value
				} else {
					obj[key] = [].concat(obj[key], value)
				}
			})

			return obj
		}

		parseURL(str)

	</script>
</body>
</html>